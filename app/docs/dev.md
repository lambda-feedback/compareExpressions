# CompareExpressions
This function utilises the [`SymPy`](https://docs.sympy.org/latest/index.html) to provide a maths-aware evaluation of a learner's response.

## Evaluation function

The main evaluation function is found in `evaluation.py` as has the following signature:

`evaluation_function(response : str, answer : str, params: dict, include_test_data=False : bool) -> dict`

### Input

This is the function that should be called to evaluate a response expression. 
- `response` is the response expression submitted by the learner
- `answer` is a reference expression provided by the task author
- `params` is a dictionary with optional parameters, for available parameters and their intended use, see the user documentation
- `include_test_data` is a boolean that controls whether some extra data useful for testing or debugging is returned

### Output

The function returns result dictionary with the following fields:
- `is_correct` is a boolean value that indicates whether the response is considered correct or not
- `feedback` is a string that provides information about what the evaluation function found when evaluating the response that is intended to be shown to the learner
- `tags` is a list of strings that encode some information about what the evaluation function has found out about the response, more consistent across similar tasks than the string output in feedback

The returned dictionary will be referred to as the `result` in this documentation.

### Overview
The overall flow of the evaluation procedure can be described as follows:

1. The function uses the paramters given in `params` to determine the context of the evaluation. What context means will be discussed in more detail in a later section.
2. After the context is determined the response, answer and criteria (either supplied via `params` or from the context) are analysed an necessary information is stored for future use in a dictionary with frozen valuues, i.e. a dictionary where new items can be added but existing items cannot be changed.
3. The feedback generating procedure supplied by the context is used to generate feedback based on the contents of the frozen value dictionary.
4. If all criteria are found to be satisfied the response is considered correct, i.e. the `is_correct` field in the result is set to true and the feedback string and list of tags generated by the feedback generation procedure are added to their respective fields.

**TODO** Describe what further information is supplied when `include_test_data` is set to true.

### Context

The context is a data structure that contains at least the following seven pieves of information:
- `default_criteria` A list of strings that describe the default criteria used if none are supplied by the input parameters.
- `expression_parse` function that parses expressions (i.e. the `response` and `answer` inputs) into the form used by the feedback generation procedure.
- `expression_preprocess` function that performs string manipulations that makes ensures that correctly written input expressions follows the conventions expected by `expression_parse`.
- `expression_preview` is a function that generates a string that can be turned into a human-readable represenation of how the evaluation function interpreted the response.
- `feedback_procedure_generator` function that generates a function for each criteria that can be used to evaluate if the criteria is satisfied or not. The output from this function should be a list of tags that the feedback string generator can use to produce human readable feedback.
- `feedback_string_generator` function that takes tags and outputs human readable feedback strings.
- `generate_criteria_parser` function that generates a parser that can be used to turn the criteria (given in string form) into a form that the feedback generation procedure can use to determine if they are correct or not.

The context can also contain other fields if necessary.

**Remark:** The current implementation uses a dictionary rather than a dedicated class for ease of iteration during the prototyping phase.

**TODO** Describe currently available contexts

### Criteria

**TODO** Describe currently available contexts
